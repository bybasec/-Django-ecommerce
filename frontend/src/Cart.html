<table>
	<caption>Your Cart</caption>
	<thead>
		<tr>
			<th>Item</th>
			<th>Qty.</th>
			<th>Unit</th>
			<th>Total</th>
			<th>
				<svg on:click="fire('cart-clear')" class="icon-recycle"><use xlink:href="#icon-recycle"></use></svg>
			</th>
		</tr>
	</thead>
	<tfoot>
		<tr>
			<td colspan="3">Total</td>
			<th>${{ dollarFormat(total) }}</th>
			<td>
				<button type="button" on:click="fire('checkout')">Check Out</button>
			</td>
		</tr>
	</tfoot>
	<tbody>
		{{#each cart.items as item}}
		<tr>
			<td>{{item.name}}</td>
			<td>
				<svg on:click="fire('cart-dec', {item})" class="icon-minus"><use xlink:href="#icon-minus"></use></svg>
				{{ item.qty }}
				<svg on:click="fire('cart-inc', {item})" class="icon-plus"><use xlink:href="#icon-plus"></use></svg>
			</td>
			<td>${{ dollarFormat(item.price) }}</td>
			<td>${{ itemTotal(item) }}</td>
			<td><svg on:click="fire('cart-remove', {item})" class="icon-remove"><use xlink:href="#icon-remove"></use></svg></td>
		</tr>
		{{/each}}
	</tbody>
</table>

<script>
	import request from "./request.js";
	import { dollarFormat } from "./utils.js";

	export default {
		helpers: {
			dollarFormat,
			itemTotal: (item) => dollarFormat(item.qty * item.price)
		},
		computed: {
			total: cart => cart.items.reduce((x, y) => x + (y.qty * y.price), 0.0)
		}
	}
</script>